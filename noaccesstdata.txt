ops_triton not available No module named 'pycuda'
0
A:  [[ 2.  1. -2.]] [[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
B:  [[ 2.  1. -2.]] [[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
C:  [[ 2.  1. -2.]] [[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
BEFORE optim |  True  | self.m[0].data [[0. 0. 0.]] self.v[0].data [[0. 0. 0.]]
1 - t.grad:  [[1.334759   0.75527155 0.        ]]
2 - t.grad:  [[1.334759   0.75527155 0.        ]]
1 - t.grad:  [[ 2.669518    1.5105431   0.        ]
 [ 1.334759    0.75527155  0.        ]
 [-2.669518   -1.5105431   0.        ]]
2 - t.grad:  [[ 2.669518    1.5105431   0.        ]
 [ 1.334759    0.75527155  0.        ]
 [-2.669518   -1.5105431   0.        ]]
AFTER optim |  True  | self.m[0].data [[0.1334759  0.07552715 0.        ]] self.v[0].data [[0.00178158 0.00057044 0.        ]]
D:  [[ 1.9986562   0.99865615 -2.        ]] [[ 9.990000e-01 -9.999932e-04  0.000000e+00]
 [-9.999932e-04  9.990000e-01  0.000000e+00]
 [ 9.999933e-04  9.999932e-04  1.000000e+00]]
########################################
1
A:  [[ 1.9986562   0.99865615 -2.        ]] [[ 9.990000e-01 -9.999932e-04  0.000000e+00]
 [-9.999932e-04  9.990000e-01  0.000000e+00]
 [ 9.999933e-04  9.999932e-04  1.000000e+00]]
B:  [[ 1.9986562   0.99865615 -2.        ]] [[ 9.990000e-01 -9.999932e-04  0.000000e+00]
 [-9.999932e-04  9.990000e-01  0.000000e+00]
 [ 9.999933e-04  9.999932e-04  1.000000e+00]]
C:  [[ 1.9986562   0.99865615 -2.        ]] [[ 9.990000e-01 -9.999932e-04  0.000000e+00]
 [-9.999932e-04  9.990000e-01  0.000000e+00]
 [ 9.999933e-04  9.999932e-04  1.000000e+00]]
BEFORE optim |  True  | self.m[0].data [[0.1334759  0.07552715 0.        ]] self.v[0].data [[0.00178158 0.00057044 0.        ]]
1 - t.grad:  [[2.6678081e+00 1.5085926e+00 2.0905372e-03]]
2 - t.grad:  [[2.6678081e+00 1.5085926e+00 2.0905372e-03]]
1 - t.grad:  [[ 5.338003   3.020351   0.       ]
 [ 2.6681046  1.5096679  0.       ]
 [-5.3397975 -3.0213661  0.       ]]
2 - t.grad:  [[ 5.338003   3.020351   0.       ]
 [ 2.6681046  1.5096679  0.       ]
 [-5.3397975 -3.0213661  0.       ]]
AFTER optim |  True  | self.m[0].data [[3.8690913e-01 2.1883370e-01 2.0905373e-04]] self.v[0].data [[8.8970000e-03 2.8457164e-03 4.3703459e-09]]
D:  [[ 1.9975122  0.9975122 -2.001    ]] [[ 0.99785614 -0.00214387  0.        ]
 [-0.00214389  0.9978561   0.        ]
 [ 0.00214384  0.00214385  1.        ]]
########################################
2
A:  [[ 1.9975122  0.9975122 -2.001    ]] [[ 0.99785614 -0.00214387  0.        ]
 [-0.00214389  0.9978561   0.        ]
 [ 0.00214384  0.00214385  1.        ]]
B:  [[ 1.9975122  0.9975122 -2.001    ]] [[ 0.99785614 -0.00214387  0.        ]
 [-0.00214389  0.9978561   0.        ]
 [ 0.00214384  0.00214385  1.        ]]
C:  [[ 1.9975122  0.9975122 -2.001    ]] [[ 0.99785614 -0.00214387  0.        ]
 [-0.00214389  0.9978561   0.        ]
 [ 0.00214384  0.00214385  1.        ]]
BEFORE optim |  True  | self.m[0].data [[3.8690913e-01 2.1883370e-01 2.0905373e-04]] self.v[0].data [[8.8970000e-03 2.8457164e-03 4.3703459e-09]]
1 - t.grad:  [[3.998879   2.2596734  0.00657357]]
2 - t.grad:  [[3.998879   2.2596734  0.00657357]]
1 - t.grad:  [[ 8.005789   4.529599   0.       ]
 [ 4.0003357  2.2633522  0.       ]
 [-8.01224   -4.5332494  0.       ]]
2 - t.grad:  [[ 8.005789   4.529599   0.       ]
 [ 4.0003357  2.2633522  0.       ]
 [-8.01224   -4.5332494  0.       ]]
AFTER optim |  True  | self.m[0].data [[0.7481061  0.42291766 0.00084551]] self.v[0].data [[2.4879137e-02 7.9489946e-03 4.7577775e-08]]
D:  [[ 1.9964396   0.99643946 -2.001951  ]] [[ 0.9967835  -0.0032165   0.        ]
 [-0.00321656  0.99678344  0.        ]
 [ 0.00321641  0.00321642  1.        ]]
########################################
