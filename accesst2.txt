ops_triton not available No module named 'pycuda'
0
A:  [[ 2.  1. -2.]] [[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
B:  [[ 2.  1. -2.]] [[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
C:  [[ 2.  1. -2.]] [[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
C grads:  [[1.334759   0.75527155 0.        ]] [[ 2.669518    1.5105431   0.        ]
 [ 1.334759    0.75527155  0.        ]
 [-2.669518   -1.5105431   0.        ]]
BEFORE optim |  True  | self.m[0].data [[0. 0. 0.]] self.v[0].data [[0. 0. 0.]]
1 - t.grad:  [[1.334759   0.75527155 0.        ]]
2 - t.grad:  [[1.334759   0.75527155 0.        ]]
1 - t.grad:  [[ 2.669518    1.5105431   0.        ]
 [ 1.334759    0.75527155  0.        ]
 [-2.669518   -1.5105431   0.        ]]
2 - t.grad:  [[ 2.669518    1.5105431   0.        ]
 [ 1.334759    0.75527155  0.        ]
 [-2.669518   -1.5105431   0.        ]]
AFTER optim |  True  | self.m[0].data [[0.1334759  0.07552715 0.        ]] self.v[0].data [[0.00178158 0.00057044 0.        ]]
D:  [[ 1.999  0.999 -2.   ]] [[ 9.990000e-01 -9.999932e-04  0.000000e+00]
 [-9.999932e-04  9.990000e-01  0.000000e+00]
 [ 9.999933e-04  9.999932e-04  1.000000e+00]]
########################################
1
A:  [[ 1.999  0.999 -2.   ]] [[ 9.990000e-01 -9.999932e-04  0.000000e+00]
 [-9.999932e-04  9.990000e-01  0.000000e+00]
 [ 9.999933e-04  9.999932e-04  1.000000e+00]]
B:  [[ 1.999  0.999 -2.   ]] [[ 9.990000e-01 -9.999932e-04  0.000000e+00]
 [-9.999932e-04  9.990000e-01  0.000000e+00]
 [ 9.999933e-04  9.999932e-04  1.000000e+00]]
C:  [[ 1.999  0.999 -2.   ]] [[ 9.990000e-01 -9.999932e-04  0.000000e+00]
 [-9.999932e-04  9.990000e-01  0.000000e+00]
 [ 9.999933e-04  9.999932e-04  1.000000e+00]]
C grads:  [[2.6677876e+00 1.5085851e+00 2.0905090e-03]] [[ 5.3384213  3.0205956  0.       ]
 [ 2.668543   1.5099201  0.       ]
 [-5.3397565 -3.021351   0.       ]]
BEFORE optim |  True  | self.m[0].data [[0.1334759  0.07552715 0.        ]] self.v[0].data [[0.00178158 0.00057044 0.        ]]
1 - t.grad:  [[2.6677876e+00 1.5085851e+00 2.0905090e-03]]
2 - t.grad:  [[2.6677876e+00 1.5085851e+00 2.0905090e-03]]
1 - t.grad:  [[ 5.3384213  3.0205956  0.       ]
 [ 2.668543   1.5099201  0.       ]
 [-5.3397565 -3.021351   0.       ]]
2 - t.grad:  [[ 5.3384213  3.0205956  0.       ]
 [ 2.668543   1.5099201  0.       ]
 [-5.3397565 -3.021351   0.       ]]
AFTER optim |  True  | self.m[0].data [[3.8690707e-01 2.1883294e-01 2.0905091e-04]] self.v[0].data [[8.8968910e-03 2.8456938e-03 4.3702282e-09]]
D:  [[ 1.9980347  0.9980347 -2.000744 ]] [[ 0.99803483 -0.00196518  0.        ]
 [-0.0019652   0.9980348   0.        ]
 [ 0.00196515  0.00196516  1.        ]]
########################################
2
A:  [[ 1.9980347  0.9980347 -2.000744 ]] [[ 0.99803483 -0.00196518  0.        ]
 [-0.0019652   0.9980348   0.        ]
 [ 0.00196515  0.00196516  1.        ]]
B:  [[ 1.9980347  0.9980347 -2.000744 ]] [[ 0.99803483 -0.00196518  0.        ]
 [-0.0019652   0.9980348   0.        ]
 [ 0.00196515  0.00196516  1.        ]]
C:  [[ 1.9980347  0.9980347 -2.000744 ]] [[ 0.99803483 -0.00196518  0.        ]
 [-0.0019652   0.9980348   0.        ]
 [ 0.00196515  0.00196516  1.        ]]
C grads:  [[3.9991467  2.2600083  0.00619965]] [[ 8.006733   4.5301757  0.       ]
 [ 4.0013866  2.2639678  0.       ]
 [-8.011686  -4.532978   0.       ]]
BEFORE optim |  True  | self.m[0].data [[3.8690707e-01 2.1883294e-01 2.0905091e-04]] self.v[0].data [[8.8968910e-03 2.8456938e-03 4.3702282e-09]]
1 - t.grad:  [[3.9991467  2.2600083  0.00619965]]
2 - t.grad:  [[3.9991467  2.2600083  0.00619965]]
1 - t.grad:  [[ 8.006733   4.5301757  0.       ]
 [ 4.0013866  2.2639678  0.       ]
 [-8.011686  -4.532978   0.       ]]
2 - t.grad:  [[ 8.006733   4.5301757  0.       ]
 [ 4.0013866  2.2639678  0.       ]
 [-8.011686  -4.532978   0.       ]]
AFTER optim |  True  | self.m[0].data [[0.74813104 0.42295048 0.00080811]] self.v[0].data [[2.4881169e-02 7.9504866e-03 4.2801464e-08]]
D:  [[ 1.9970766  0.9970765 -2.001533 ]] [[ 0.9970768  -0.00292321  0.        ]
 [-0.00292326  0.9970767   0.        ]
 [ 0.00292311  0.00292313  1.        ]]
########################################
3
A:  [[ 1.9970766  0.9970765 -2.001533 ]] [[ 0.9970768  -0.00292321  0.        ]
 [-0.00292326  0.9970767   0.        ]
 [ 0.00292311  0.00292313  1.        ]]
B:  [[ 1.9970766  0.9970765 -2.001533 ]] [[ 0.9970768  -0.00292321  0.        ]
 [-0.00292326  0.9970767   0.        ]
 [ 0.00292311  0.00292313  1.        ]]
C:  [[ 1.9970766  0.9970765 -2.001533 ]] [[ 0.9970768  -0.00292321  0.        ]
 [-0.00292326  0.9970767   0.        ]
 [ 0.00292311  0.00292313  1.        ]]
C grads:  [[5.3288493  3.0095549  0.01231328]] [[ 10.67446     6.0392876   0.       ]
 [  5.3332977   3.017419    0.       ]
 [-10.685367   -6.045458    0.       ]]
BEFORE optim |  True  | self.m[0].data [[0.74813104 0.42295048 0.00080811]] self.v[0].data [[2.4881169e-02 7.9504866e-03 4.2801464e-08]]
1 - t.grad:  [[5.3288493  3.0095549  0.01231328]]
2 - t.grad:  [[5.3288493  3.0095549  0.01231328]]
1 - t.grad:  [[ 10.67446     6.0392876   0.       ]
 [  5.3332977   3.017419    0.       ]
 [-10.685367   -6.045458    0.       ]]
2 - t.grad:  [[ 10.67446     6.0392876   0.       ]
 [  5.3332977   3.017419    0.       ]
 [-10.685367   -6.045458    0.       ]]
AFTER optim |  True  | self.m[0].data [[1.2062029  0.68161094 0.00195863]] self.v[0].data [[5.3252924e-02 1.6999956e-02 1.9437550e-07]]
D:  [[ 1.996116   0.9961158 -2.0023494]] [[ 0.9961164  -0.00388364  0.        ]
 [-0.00388375  0.9961162   0.        ]
 [ 0.00388346  0.00388348  1.        ]]
########################################
4
A:  [[ 1.996116   0.9961158 -2.0023494]] [[ 0.9961164  -0.00388364  0.        ]
 [-0.00388375  0.9961162   0.        ]
 [ 0.00388346  0.00388348  1.        ]]
B:  [[ 1.996116   0.9961158 -2.0023494]] [[ 0.9961164  -0.00388364  0.        ]
 [-0.00388375  0.9961162   0.        ]
 [ 0.00388346  0.00388348  1.        ]]
C:  [[ 1.996116   0.9961158 -2.0023494]] [[ 0.9961164  -0.00388364  0.        ]
 [-0.00388375  0.9961162   0.        ]
 [ 0.00388346  0.00388348  1.        ]]
C grads:  [[6.656892   3.7572198  0.02043732]] [[ 13.341604    7.547931    0.       ]
 [  6.664274    3.770273    0.       ]
 [-13.360839   -7.5588126   0.       ]]
BEFORE optim |  True  | self.m[0].data [[1.2062029  0.68161094 0.00195863]] self.v[0].data [[5.3252924e-02 1.6999956e-02 1.9437550e-07]]
1 - t.grad:  [[6.656892   3.7572198  0.02043732]]
2 - t.grad:  [[6.656892   3.7572198  0.02043732]]
1 - t.grad:  [[ 13.341604    7.547931    0.       ]
 [  6.664274    3.770273    0.       ]
 [-13.360839   -7.5588126   0.       ]]
2 - t.grad:  [[ 13.341604    7.547931    0.       ]
 [  6.664274    3.770273    0.       ]
 [-13.360839   -7.5588126   0.       ]]
AFTER optim |  True  | self.m[0].data [[1.7512717 0.9891718 0.0038065]] self.v[0].data [[9.7513884e-02 3.1099657e-02 6.1186529e-07]]
D:  [[ 1.9951487   0.99514824 -2.0031888 ]] [[ 0.99514914 -0.00485091  0.        ]
 [-0.00485107  0.9951489   0.        ]
 [ 0.00485062  0.00485065  1.        ]]
########################################
5
A:  [[ 1.9951487   0.99514824 -2.0031888 ]] [[ 0.99514914 -0.00485091  0.        ]
 [-0.00485107  0.9951489   0.        ]
 [ 0.00485062  0.00485065  1.        ]]
B:  [[ 1.9951487   0.99514824 -2.0031888 ]] [[ 0.99514914 -0.00485091  0.        ]
 [-0.00485107  0.9951489   0.        ]
 [ 0.00485062  0.00485065  1.        ]]
C:  [[ 1.9951487   0.99514824 -2.0031888 ]] [[ 0.99514914 -0.00485091  0.        ]
 [-0.00485107  0.9951489   0.        ]
 [ 0.00485062  0.00485065  1.        ]]
C grads:  [[7.983263   4.502989   0.03058698]] [[ 16.008163    9.056104    0.       ]
 [  7.994311    4.5225253   0.       ]
 [-16.038143   -9.073063    0.       ]]
BEFORE optim |  True  | self.m[0].data [[1.7512717 0.9891718 0.0038065]] self.v[0].data [[9.7513884e-02 3.1099657e-02 6.1186529e-07]]
1 - t.grad:  [[7.983263   4.502989   0.03058698]]
2 - t.grad:  [[7.983263   4.502989   0.03058698]]
1 - t.grad:  [[ 16.008163    9.056104    0.       ]
 [  7.994311    4.5225253   0.       ]
 [-16.038143   -9.073063    0.       ]]
2 - t.grad:  [[ 16.008163    9.056104    0.       ]
 [  7.994311    4.5225253   0.       ]
 [-16.038143   -9.073063    0.       ]]
AFTER optim |  True  | self.m[0].data [[2.3744707  1.3405535  0.00648455]] self.v[0].data [[1.6114886e-01 5.1345468e-02 1.5468170e-06]]
D:  [[ 1.9941721   0.99417144 -2.0040498 ]] [[ 0.9941727  -0.00582739  0.        ]
 [-0.00582759  0.99417233  0.        ]
 [ 0.00582696  0.00582701  1.        ]]
########################################
6
A:  [[ 1.9941721   0.99417144 -2.0040498 ]] [[ 0.9941727  -0.00582739  0.        ]
 [-0.00582759  0.99417233  0.        ]
 [ 0.00582696  0.00582701  1.        ]]
B:  [[ 1.9941721   0.99417144 -2.0040498 ]] [[ 0.9941727  -0.00582739  0.        ]
 [-0.00582759  0.99417233  0.        ]
 [ 0.00582696  0.00582701  1.        ]]
C:  [[ 1.9941721   0.99417144 -2.0040498 ]] [[ 0.9941727  -0.00582739  0.        ]
 [-0.00582759  0.99417233  0.        ]
 [ 0.00582696  0.00582701  1.        ]]
C grads:  [[9.307947   5.2468443  0.04278246]] [[ 18.674133  10.563802   0.      ]
 [  9.3234     5.274171   0.      ]
 [-18.717318 -10.588229   0.      ]]
BEFORE optim |  True  | self.m[0].data [[2.3744707  1.3405535  0.00648455]] self.v[0].data [[1.6114886e-01 5.1345468e-02 1.5468170e-06]]
1 - t.grad:  [[9.307947   5.2468443  0.04278246]]
2 - t.grad:  [[9.307947   5.2468443  0.04278246]]
1 - t.grad:  [[ 18.674133  10.563802   0.      ]
 [  9.3234     5.274171   0.      ]
 [-18.717318 -10.588229   0.      ]]
2 - t.grad:  [[ 18.674133  10.563802   0.      ]
 [  9.3234     5.274171   0.      ]
 [-18.717318 -10.588229   0.      ]]
AFTER optim |  True  | self.m[0].data [[3.0678184  1.7311826  0.01011434]] self.v[0].data [[2.4762560e-01 7.8823499e-02 3.3756096e-06]]
D:  [[ 1.9931849   0.99318403 -2.0049312 ]] [[ 0.99318564 -0.00681444  0.        ]
 [-0.00681471  0.9931852   0.        ]
 [ 0.00681388  0.00681394  1.        ]]
########################################
7
A:  [[ 1.9931849   0.99318403 -2.0049312 ]] [[ 0.99318564 -0.00681444  0.        ]
 [-0.00681471  0.9931852   0.        ]
 [ 0.00681388  0.00681394  1.        ]]
B:  [[ 1.9931849   0.99318403 -2.0049312 ]] [[ 0.99318564 -0.00681444  0.        ]
 [-0.00681471  0.9931852   0.        ]
 [ 0.00681388  0.00681394  1.        ]]
C:  [[ 1.9931849   0.99318403 -2.0049312 ]] [[ 0.99318564 -0.00681444  0.        ]
 [-0.00681471  0.9931852   0.        ]
 [ 0.00681388  0.00681394  1.        ]]
C grads:  [[10.630927    5.988765    0.05704691]] [[ 21.33951   12.071021   0.      ]
 [ 10.65153    6.025203   0.      ]
 [-21.398403 -12.104331   0.      ]]
BEFORE optim |  True  | self.m[0].data [[3.0678184  1.7311826  0.01011434]] self.v[0].data [[2.4762560e-01 7.8823499e-02 3.3756096e-06]]
1 - t.grad:  [[10.630927    5.988765    0.05704691]]
2 - t.grad:  [[10.630927    5.988765    0.05704691]]
1 - t.grad:  [[ 21.33951   12.071021   0.      ]
 [ 10.65153    6.025203   0.      ]
 [-21.398403 -12.104331   0.      ]]
2 - t.grad:  [[ 21.33951   12.071021   0.      ]
 [ 10.65153    6.025203   0.      ]
 [-21.398403 -12.104331   0.      ]]
AFTER optim |  True  | self.m[0].data [[3.824129   2.1569407  0.01480759]] self.v[0].data [[3.6039460e-01 1.1460999e-01 6.6265839e-06]]
D:  [[ 1.9921863  0.9921852 -2.005833 ]] [[ 0.99218714 -0.00781293  0.        ]
 [-0.00781326  0.99218667  0.        ]
 [ 0.00781223  0.00781231  1.        ]]
########################################
8
A:  [[ 1.9921863  0.9921852 -2.005833 ]] [[ 0.99218714 -0.00781293  0.        ]
 [-0.00781326  0.99218667  0.        ]
 [ 0.00781223  0.00781231  1.        ]]
B:  [[ 1.9921863  0.9921852 -2.005833 ]] [[ 0.99218714 -0.00781293  0.        ]
 [-0.00781326  0.99218667  0.        ]
 [ 0.00781223  0.00781231  1.        ]]
C:  [[ 1.9921863  0.9921852 -2.005833 ]] [[ 0.99218714 -0.00781293  0.        ]
 [-0.00781326  0.99218667  0.        ]
 [ 0.00781223  0.00781231  1.        ]]
C grads:  [[11.952184    6.7287273   0.07340531]] [[ 24.00429    13.577757    0.       ]
 [ 11.978693    6.7756157   0.       ]
 [-24.081438  -13.621388    0.       ]]
BEFORE optim |  True  | self.m[0].data [[3.824129   2.1569407  0.01480759]] self.v[0].data [[3.6039460e-01 1.1460999e-01 6.6265839e-06]]
1 - t.grad:  [[11.952184    6.7287273   0.07340531]]
2 - t.grad:  [[11.952184    6.7287273   0.07340531]]
1 - t.grad:  [[ 24.00429    13.577757    0.       ]
 [ 11.978693    6.7756157   0.       ]
 [-24.081438  -13.621388    0.       ]]
2 - t.grad:  [[ 24.00429    13.577757    0.       ]
 [ 11.978693    6.7756157   0.       ]
 [-24.081438  -13.621388    0.       ]]
AFTER optim |  True  | self.m[0].data [[4.6369348  2.6141193  0.02066736]] self.v[0].data [[5.0288892e-01 1.5977116e-01 1.2008297e-05]]
D:  [[ 1.9911757  0.9911744 -2.0067546]] [[ 0.99117666 -0.00882339  0.        ]
 [-0.00882378  0.9911761   0.        ]
 [ 0.00882256  0.00882265  1.        ]]
########################################
9
A:  [[ 1.9911757  0.9911744 -2.0067546]] [[ 0.99117666 -0.00882339  0.        ]
 [-0.00882378  0.9911761   0.        ]
 [ 0.00882256  0.00882265  1.        ]]
B:  [[ 1.9911757  0.9911744 -2.0067546]] [[ 0.99117666 -0.00882339  0.        ]
 [-0.00882378  0.9911761   0.        ]
 [ 0.00882256  0.00882265  1.        ]]
C:  [[ 1.9911757  0.9911744 -2.0067546]] [[ 0.99117666 -0.00882339  0.        ]
 [-0.00882378  0.9911761   0.        ]
 [ 0.00882256  0.00882265  1.        ]]
C grads:  [[13.271697    7.4667077   0.09188382]] [[ 26.668468  15.084005   0.      ]
 [ 13.304877   7.525401   0.      ]
 [-26.766462 -15.139421   0.      ]]
BEFORE optim |  True  | self.m[0].data [[4.6369348  2.6141193  0.02066736]] self.v[0].data [[5.0288892e-01 1.5977116e-01 1.2008297e-05]]
1 - t.grad:  [[13.271697    7.4667077   0.09188382]]
2 - t.grad:  [[13.271697    7.4667077   0.09188382]]
1 - t.grad:  [[ 26.668468  15.084005   0.      ]
 [ 13.304877   7.525401   0.      ]
 [-26.766462 -15.139421   0.      ]]
2 - t.grad:  [[ 26.668468  15.084005   0.      ]
 [ 13.304877   7.525401   0.      ]
 [-26.766462 -15.139421   0.      ]]
AFTER optim |  True  | self.m[0].data [[5.500411   3.099378   0.02778901]] self.v[0].data [[6.7852402e-01 2.1536312e-01 2.0438925e-05]]
D:  [[ 1.9901527  0.9901513 -2.0076962]] [[ 0.9901539  -0.00984617  0.        ]
 [-0.00984661  0.9901533   0.        ]
 [ 0.0098452   0.0098453   1.        ]]
########################################
10
A:  [[ 1.9901527  0.9901513 -2.0076962]] [[ 0.9901539  -0.00984617  0.        ]
 [-0.00984661  0.9901533   0.        ]
 [ 0.0098452   0.0098453   1.        ]]
B:  [[ 1.9901527  0.9901513 -2.0076962]] [[ 0.9901539  -0.00984617  0.        ]
 [-0.00984661  0.9901533   0.        ]
 [ 0.0098452   0.0098453   1.        ]]
C:  [[ 1.9901527  0.9901513 -2.0076962]] [[ 0.9901539  -0.00984617  0.        ]
 [-0.00984661  0.9901533   0.        ]
 [ 0.0098452   0.0098453   1.        ]]
C grads:  [[14.589446    8.202682    0.11250938]] [[ 29.332043  16.58976    0.      ]
 [ 14.630073   8.274552   0.      ]
 [-29.453516 -16.65845    0.      ]]
BEFORE optim |  True  | self.m[0].data [[5.500411   3.099378   0.02778901]] self.v[0].data [[6.7852402e-01 2.1536312e-01 2.0438925e-05]]
1 - t.grad:  [[14.589446    8.202682    0.11250938]]
2 - t.grad:  [[14.589446    8.202682    0.11250938]]
1 - t.grad:  [[ 29.332043  16.58976    0.      ]
 [ 14.630073   8.274552   0.      ]
 [-29.453516 -16.65845    0.      ]]
2 - t.grad:  [[ 29.332043  16.58976    0.      ]
 [ 14.630073   8.274552   0.      ]
 [-29.453516 -16.65845    0.      ]]
AFTER optim |  True  | self.m[0].data [[6.4093146  3.6097083  0.03626105]] self.v[0].data [[8.9069742e-01 2.8243172e-01 3.3076849e-05]]
D:  [[ 1.9891173  0.9891157 -2.0086575]] [[ 0.98911864 -0.01088145  0.        ]
 [-0.01088195  0.989118    0.        ]
 [ 0.01088036  0.01088047  1.        ]]
########################################
11
A:  [[ 1.9891173  0.9891157 -2.0086575]] [[ 0.98911864 -0.01088145  0.        ]
 [-0.01088195  0.989118    0.        ]
 [ 0.01088036  0.01088047  1.        ]]
B:  [[ 1.9891173  0.9891157 -2.0086575]] [[ 0.98911864 -0.01088145  0.        ]
 [-0.01088195  0.989118    0.        ]
 [ 0.01088036  0.01088047  1.        ]]
C:  [[ 1.9891173  0.9891157 -2.0086575]] [[ 0.98911864 -0.01088145  0.        ]
 [-0.01088195  0.989118    0.        ]
 [ 0.01088036  0.01088047  1.        ]]
C grads:  [[15.90541    8.936625   0.1353094]] [[ 31.995005   18.095016    0.       ]
 [ 15.9542675   9.023062    0.       ]
 [-32.14264   -18.178493    0.       ]]
BEFORE optim |  True  | self.m[0].data [[6.4093146  3.6097083  0.03626105]] self.v[0].data [[8.9069742e-01 2.8243172e-01 3.3076849e-05]]
1 - t.grad:  [[15.90541    8.936625   0.1353094]]
2 - t.grad:  [[15.90541    8.936625   0.1353094]]
1 - t.grad:  [[ 31.995005   18.095016    0.       ]
 [ 15.9542675   9.023062    0.       ]
 [-32.14264   -18.178493    0.       ]]
2 - t.grad:  [[ 31.995005   18.095016    0.       ]
 [ 15.9542675   9.023062    0.       ]
 [-32.14264   -18.178493    0.       ]]
AFTER optim |  True  | self.m[0].data [[7.358924   4.1424     0.04616588]] self.v[0].data [[1.1427889e+00 3.6201257e-01 5.1352406e-05]]
D:  [[ 1.9880693   0.98806757 -2.0096383 ]] [[ 0.9880707  -0.01192934  0.        ]
 [-0.01192988  0.98807     0.        ]
 [ 0.01192814  0.01192826  1.        ]]
########################################
12
A:  [[ 1.9880693   0.98806757 -2.0096383 ]] [[ 0.9880707  -0.01192934  0.        ]
 [-0.01192988  0.98807     0.        ]
 [ 0.01192814  0.01192826  1.        ]]
B:  [[ 1.9880693   0.98806757 -2.0096383 ]] [[ 0.9880707  -0.01192934  0.        ]
 [-0.01192988  0.98807     0.        ]
 [ 0.01192814  0.01192826  1.        ]]
C:  [[ 1.9880693   0.98806757 -2.0096383 ]] [[ 0.9880707  -0.01192934  0.        ]
 [-0.01192988  0.98807     0.        ]
 [ 0.01192814  0.01192826  1.        ]]
C grads:  [[17.219568    9.66851     0.16031152]] [[ 34.657352  19.59977    0.      ]
 [ 17.27745    9.770922   0.      ]
 [-34.83387  -19.699574   0.      ]]
BEFORE optim |  True  | self.m[0].data [[7.358924   4.1424     0.04616588]] self.v[0].data [[1.1427889e+00 3.6201257e-01 5.1352406e-05]]
1 - t.grad:  [[17.219568    9.66851     0.16031152]]
2 - t.grad:  [[17.219568    9.66851     0.16031152]]
1 - t.grad:  [[ 34.657352  19.59977    0.      ]
 [ 17.27745    9.770922   0.      ]
 [-34.83387  -19.699574   0.      ]]
2 - t.grad:  [[ 34.657352  19.59977    0.      ]
 [ 17.27745    9.770922   0.      ]
 [-34.83387  -19.699574   0.      ]]
AFTER optim |  True  | self.m[0].data [[8.344988   4.6950107  0.05758045]] self.v[0].data [[1.4381597e+00 4.5513067e-01 7.7000841e-05]]
D:  [[ 1.9870087   0.98700684 -2.0106385 ]] [[ 0.9870102  -0.01298987  0.        ]
 [-0.01299045  0.9870094   0.        ]
 [ 0.01298858  0.01298872  1.        ]]
########################################
13
A:  [[ 1.9870087   0.98700684 -2.0106385 ]] [[ 0.9870102  -0.01298987  0.        ]
 [-0.01299045  0.9870094   0.        ]
 [ 0.01298858  0.01298872  1.        ]]
B:  [[ 1.9870087   0.98700684 -2.0106385 ]] [[ 0.9870102  -0.01298987  0.        ]
 [-0.01299045  0.9870094   0.        ]
 [ 0.01298858  0.01298872  1.        ]]
C:  [[ 1.9870087   0.98700684 -2.0106385 ]] [[ 0.9870102  -0.01298987  0.        ]
 [-0.01299045  0.9870094   0.        ]
 [ 0.01298858  0.01298872  1.        ]]
C grads:  [[18.531898   10.398314    0.18754356]] [[ 37.31908   21.104015   0.      ]
 [ 18.599611  10.518126   0.      ]
 [-37.527252 -21.221708   0.      ]]
BEFORE optim |  True  | self.m[0].data [[8.344988   4.6950107  0.05758045]] self.v[0].data [[1.4381597e+00 4.5513067e-01 7.7000841e-05]]
1 - t.grad:  [[18.531898   10.398314    0.18754356]]
2 - t.grad:  [[18.531898   10.398314    0.18754356]]
1 - t.grad:  [[ 37.31908   21.104015   0.      ]
 [ 18.599611  10.518126   0.      ]
 [-37.527252 -21.221708   0.      ]]
2 - t.grad:  [[ 37.31908   21.104015   0.      ]
 [ 18.599611  10.518126   0.      ]
 [-37.527252 -21.221708   0.      ]]
AFTER optim |  True  | self.m[0].data [[9.363679   5.2653413  0.07057676]] self.v[0].data [[1.7801528e+00 5.6280053e-01 1.1209643e-04]]
D:  [[ 1.9859354   0.98593354 -2.011658  ]] [[ 0.98593706 -0.01406302  0.        ]
 [-0.01406362  0.9859362   0.        ]
 [ 0.01406167  0.01406181  1.        ]]
########################################
14
A:  [[ 1.9859354   0.98593354 -2.011658  ]] [[ 0.98593706 -0.01406302  0.        ]
 [-0.01406362  0.9859362   0.        ]
 [ 0.01406167  0.01406181  1.        ]]
B:  [[ 1.9859354   0.98593354 -2.011658  ]] [[ 0.98593706 -0.01406302  0.        ]
 [-0.01406362  0.9859362   0.        ]
 [ 0.01406167  0.01406181  1.        ]]
C:  [[ 1.9859354   0.98593354 -2.011658  ]] [[ 0.98593706 -0.01406302  0.        ]
 [-0.01406362  0.9859362   0.        ]
 [ 0.01406167  0.01406181  1.        ]]
C grads:  [[19.84238    11.126012    0.21703331]] [[ 39.980186  22.607748   0.      ]
 [ 19.920738  11.264666   0.      ]
 [-40.222824 -22.744917   0.      ]]
BEFORE optim |  True  | self.m[0].data [[9.363679   5.2653413  0.07057676]] self.v[0].data [[1.7801528e+00 5.6280053e-01 1.1209643e-04]]
1 - t.grad:  [[19.84238    11.126012    0.21703331]]
2 - t.grad:  [[19.84238    11.126012    0.21703331]]
1 - t.grad:  [[ 39.980186  22.607748   0.      ]
 [ 19.920738  11.264666   0.      ]
 [-40.222824 -22.744917   0.      ]]
2 - t.grad:  [[ 39.980186  22.607748   0.      ]
 [ 19.920738  11.264666   0.      ]
 [-40.222824 -22.744917   0.      ]]
AFTER optim |  True  | self.m[0].data [[10.411549    5.8514085   0.08522242]] self.v[0].data [[2.1720927e+00 6.8602586e-01 1.5908779e-04]]
D:  [[ 1.9848497  0.9848478 -2.0126965]] [[ 0.98485136 -0.01514872  0.        ]
 [-0.01514933  0.9848505   0.        ]
 [ 0.01514733  0.01514748  1.        ]]
########################################
15
A:  [[ 1.9848497  0.9848478 -2.0126965]] [[ 0.98485136 -0.01514872  0.        ]
 [-0.01514933  0.9848505   0.        ]
 [ 0.01514733  0.01514748  1.        ]]
B:  [[ 1.9848497  0.9848478 -2.0126965]] [[ 0.98485136 -0.01514872  0.        ]
 [-0.01514933  0.9848505   0.        ]
 [ 0.01514733  0.01514748  1.        ]]
C:  [[ 1.9848497  0.9848478 -2.0126965]] [[ 0.98485136 -0.01514872  0.        ]
 [-0.01514933  0.9848505   0.        ]
 [ 0.01514733  0.01514748  1.        ]]
C grads:  [[21.150993   11.851577    0.24880853]] [[ 42.640663  24.110962   0.      ]
 [ 21.24082   12.010534   0.      ]
 [-42.920628 -24.269222   0.      ]]
BEFORE optim |  True  | self.m[0].data [[10.411549    5.8514085   0.08522242]] self.v[0].data [[2.1720927e+00 6.8602586e-01 1.5908779e-04]]
1 - t.grad:  [[21.150993   11.851577    0.24880853]]
2 - t.grad:  [[21.150993   11.851577    0.24880853]]
1 - t.grad:  [[ 42.640663  24.110962   0.      ]
 [ 21.24082   12.010534   0.      ]
 [-42.920628 -24.269222   0.      ]]
2 - t.grad:  [[ 42.640663  24.110962   0.      ]
 [ 21.24082   12.010534   0.      ]
 [-42.920628 -24.269222   0.      ]]
AFTER optim |  True  | self.m[0].data [[11.485493    6.451425    0.10158103]] self.v[0].data [[2.6172853e+00 8.2579976e-01 2.2083439e-04]]
D:  [[ 1.9837515  0.9837497 -2.013754 ]] [[ 0.9837532  -0.01624686  0.        ]
 [-0.01624747  0.98375237  0.        ]
 [ 0.01624549  0.01624563  1.        ]]
########################################
16
A:  [[ 1.9837515  0.9837497 -2.013754 ]] [[ 0.9837532  -0.01624686  0.        ]
 [-0.01624747  0.98375237  0.        ]
 [ 0.01624549  0.01624563  1.        ]]
B:  [[ 1.9837515  0.9837497 -2.013754 ]] [[ 0.9837532  -0.01624686  0.        ]
 [-0.01624747  0.98375237  0.        ]
 [ 0.01624549  0.01624563  1.        ]]
C:  [[ 1.9837515  0.9837497 -2.013754 ]] [[ 0.9837532  -0.01624686  0.        ]
 [-0.01624747  0.98375237  0.        ]
 [ 0.01624549  0.01624563  1.        ]]
C grads:  [[22.457718   12.574985    0.28289682]] [[ 45.300507  25.613653   0.      ]
 [ 22.559847  12.755725   0.      ]
 [-45.6207   -25.794641   0.      ]]
BEFORE optim |  True  | self.m[0].data [[11.485493    6.451425    0.10158103]] self.v[0].data [[2.6172853e+00 8.2579976e-01 2.2083439e-04]]
1 - t.grad:  [[22.457718   12.574985    0.28289682]]
2 - t.grad:  [[22.457718   12.574985    0.28289682]]
1 - t.grad:  [[ 45.300507  25.613653   0.      ]
 [ 22.559847  12.755725   0.      ]
 [-45.6207   -25.794641   0.      ]]
2 - t.grad:  [[ 45.300507  25.613653   0.      ]
 [ 22.559847  12.755725   0.      ]
 [-45.6207   -25.794641   0.      ]]
AFTER optim |  True  | self.m[0].data [[12.582716    7.063781    0.11971261]] self.v[0].data [[3.1190171e+00 9.8310423e-01 3.0064417e-04]]
D:  [[ 1.9826411  0.9826393 -2.0148299]] [[ 0.9826427  -0.01735733  0.        ]
 [-0.01735792  0.98264194  0.        ]
 [ 0.01735601  0.01735615  1.        ]]
########################################
17
A:  [[ 1.9826411  0.9826393 -2.0148299]] [[ 0.9826427  -0.01735733  0.        ]
 [-0.01735792  0.98264194  0.        ]
 [ 0.01735601  0.01735615  1.        ]]
B:  [[ 1.9826411  0.9826393 -2.0148299]] [[ 0.9826427  -0.01735733  0.        ]
 [-0.01735792  0.98264194  0.        ]
 [ 0.01735601  0.01735615  1.        ]]
C:  [[ 1.9826411  0.9826393 -2.0148299]] [[ 0.9826427  -0.01735733  0.        ]
 [-0.01735792  0.98264194  0.        ]
 [ 0.01735601  0.01735615  1.        ]]
C grads:  [[23.762531  13.29621    0.3193255]] [[ 47.959717  27.115818   0.      ]
 [ 23.877808  13.50023    0.      ]
 [-48.323082 -27.321194   0.      ]]
BEFORE optim |  True  | self.m[0].data [[12.582716    7.063781    0.11971261]] self.v[0].data [[3.1190171e+00 9.8310423e-01 3.0064417e-04]]
1 - t.grad:  [[23.762531  13.29621    0.3193255]]
2 - t.grad:  [[23.762531  13.29621    0.3193255]]
1 - t.grad:  [[ 47.959717  27.115818   0.      ]
 [ 23.877808  13.50023    0.      ]
 [-48.323082 -27.321194   0.      ]]
2 - t.grad:  [[ 47.959717  27.115818   0.      ]
 [ 23.877808  13.50023    0.      ]
 [-48.323082 -27.321194   0.      ]]
AFTER optim |  True  | self.m[0].data [[13.700697    7.687023    0.13967389]] self.v[0].data [[3.6805561e+00 1.1589103e+00 4.0231232e-04]]
D:  [[ 1.9815185  0.9815169 -2.0159245]] [[ 0.98152006 -0.01847998  0.        ]
 [-0.01848053  0.98151934  0.        ]
 [ 0.01847875  0.01847889  1.        ]]
########################################
18
A:  [[ 1.9815185  0.9815169 -2.0159245]] [[ 0.98152006 -0.01847998  0.        ]
 [-0.01848053  0.98151934  0.        ]
 [ 0.01847875  0.01847889  1.        ]]
B:  [[ 1.9815185  0.9815169 -2.0159245]] [[ 0.98152006 -0.01847998  0.        ]
 [-0.01848053  0.98151934  0.        ]
 [ 0.01847875  0.01847889  1.        ]]
C:  [[ 1.9815185  0.9815169 -2.0159245]] [[ 0.98152006 -0.01847998  0.        ]
 [-0.01848053  0.98151934  0.        ]
 [ 0.01847875  0.01847889  1.        ]]
C grads:  [[25.065416   14.015229    0.35812178]] [[ 50.618286  28.61745    0.      ]
 [ 25.194693  14.244042   0.      ]
 [-51.027813 -28.8489     0.      ]]
BEFORE optim |  True  | self.m[0].data [[13.700697    7.687023    0.13967389]] self.v[0].data [[3.6805561e+00 1.1589103e+00 4.0231232e-04]]
1 - t.grad:  [[25.065416   14.015229    0.35812178]]
2 - t.grad:  [[25.065416   14.015229    0.35812178]]
1 - t.grad:  [[ 50.618286  28.61745    0.      ]
 [ 25.194693  14.244042   0.      ]
 [-51.027813 -28.8489     0.      ]]
2 - t.grad:  [[ 50.618286  28.61745    0.      ]
 [ 25.194693  14.244042   0.      ]
 [-51.027813 -28.8489     0.      ]]
AFTER optim |  True  | self.m[0].data [[14.837168    8.319843    0.16151868]] self.v[0].data [[4.3051505e+00 1.3541780e+00 5.3016120e-04]]
D:  [[ 1.980384   0.9803826 -2.0170374]] [[ 0.98038536 -0.01961463  0.        ]
 [-0.01961512  0.98038477  0.        ]
 [ 0.01961356  0.01961368  1.        ]]
########################################
19
A:  [[ 1.980384   0.9803826 -2.0170374]] [[ 0.98038536 -0.01961463  0.        ]
 [-0.01961512  0.98038477  0.        ]
 [ 0.01961356  0.01961368  1.        ]]
B:  [[ 1.980384   0.9803826 -2.0170374]] [[ 0.98038536 -0.01961463  0.        ]
 [-0.01961512  0.98038477  0.        ]
 [ 0.01961356  0.01961368  1.        ]]
C:  [[ 1.980384   0.9803826 -2.0170374]] [[ 0.98038536 -0.01961463  0.        ]
 [-0.01961512  0.98038477  0.        ]
 [ 0.01961356  0.01961368  1.        ]]
C grads:  [[26.36635   14.7320175  0.3993125]] [[ 53.276215  30.118547   0.      ]
 [ 26.51049   14.987155   0.      ]
 [-53.734932 -30.377779   0.      ]]
BEFORE optim |  True  | self.m[0].data [[14.837168    8.319843    0.16151868]] self.v[0].data [[4.3051505e+00 1.3541780e+00 5.3016120e-04]]
1 - t.grad:  [[26.36635   14.7320175  0.3993125]]
2 - t.grad:  [[26.36635   14.7320175  0.3993125]]
1 - t.grad:  [[ 53.276215  30.118547   0.      ]
 [ 26.51049   14.987155   0.      ]
 [-53.734932 -30.377779   0.      ]]
2 - t.grad:  [[ 53.276215  30.118547   0.      ]
 [ 26.51049   14.987155   0.      ]
 [-53.734932 -30.377779   0.      ]]
AFTER optim |  True  | self.m[0].data [[15.990086    8.961061    0.18529806]] self.v[0].data [[4.996030e+00 1.569856e+00 6.890815e-04]]
D:  [[ 1.9792377   0.97923666 -2.0181684 ]] [[ 0.97923887 -0.0207611   0.        ]
 [-0.02076151  0.9792384   0.        ]
 [ 0.02076025  0.02076035  1.        ]]
########################################
